<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>../js/helpers.js - Readium SDK DOM Access Layer API</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="page-top-wrapper" >
        </br> </br>
    </div>
    <div class="yui3-g header">
        <div class="yui3-u-3-4" >
              
                 <h1 id="logo" style="vertical-align:center"><img src="../assets/css/logo.png" title="Readium SDK DOM Access Layer API">Readium SDK DOM Access Layer API</h1>
              
        </div>
        <div class="yui3-u-1-4 version" >
            <div id="version">
            <em>API Docs for: 0.16</em>
        </div>
        </div>
    </div>
    <div id="bd" class="yui3-g">
        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/ReadiumSDK.Models.BookmarkData.html">ReadiumSDK.Models.BookmarkData</a></li>
            
                <li><a href="../classes/ReadiumSDK.Models.CurrentPagesInfo.html">ReadiumSDK.Models.CurrentPagesInfo</a></li>
            
                <li><a href="../classes/ReadiumSDK.Models.Package.html">ReadiumSDK.Models.Package</a></li>
            
                <li><a href="../classes/ReadiumSDK.Models.PackageData.html">ReadiumSDK.Models.PackageData</a></li>
            
                <li><a href="../classes/ReadiumSDK.Models.Spine.html">ReadiumSDK.Models.Spine</a></li>
            
                <li><a href="../classes/ReadiumSDK.Models.SpineItem.html">ReadiumSDK.Models.SpineItem</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: ../js/helpers.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
//  LauncherOSX
//
//  Created by Boris Schneiderman.
//  Copyright (c) 2014 Readium Foundation and/or its licensees. All rights reserved.
//  
//  Redistribution and use in source and binary forms, with or without modification, 
//  are permitted provided that the following conditions are met:
//  1. Redistributions of source code must retain the above copyright notice, this 
//  list of conditions and the following disclaimer.
//  2. Redistributions in binary form must reproduce the above copyright notice, 
//  this list of conditions and the following disclaimer in the documentation and/or 
//  other materials provided with the distribution.
//  3. Neither the name of the organization nor the names of its contributors may be 
//  used to endorse or promote products derived from this software without specific 
//  prior written permission.
//  
//  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND 
//  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED 
//  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. 
//  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, 
//  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, 
//  BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, 
//  DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF 
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE 
//  OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED 
//  OF THE POSSIBILITY OF SUCH DAMAGE.

/**
 *
 * @param left
 * @param top
 * @param width
 * @param height
 * @constructor
 */
ReadiumSDK.Helpers.Rect = function(left, top, width, height) {

    this.left = left;
    this.top = top;
    this.width = width;
    this.height = height;

    this.right = function () {
        return this.left + this.width;
    };

    this.bottom = function() {
        return this.top + this.height;
    };

    this.isOverlap = function(rect, tolerance) {

        if(tolerance == undefined) {
            tolerance = 0;
        }

        return !(rect.right() &lt; this.left + tolerance ||
            rect.left &gt; this.right() - tolerance ||
            rect.bottom() &lt; this.top + tolerance ||
            rect.top &gt; this.bottom() - tolerance);
    }
};

/**
 *
 * @param $element
 * @returns {ReadiumSDK.Helpers.Rect}
 */
//This method treats multicolumn view as one long column and finds the rectangle of the element in this &quot;long&quot; column
//we are not using jQuery Offset() and width()/height() function because for multicolumn rendition_layout it produces rectangle as a bounding box of element that
// reflows between columns this is inconstant and difficult to analyze .
ReadiumSDK.Helpers.Rect.fromElement = function($element) {

    var e;
    if (_.isArray($element) || $element instanceof jQuery)
       e = $element[0];
    else
        e = $element;
    // TODODM this is somewhat hacky. Text (range?) elements don&#x27;t have a position so we have to ask the parent.
    if (e.nodeType === 3)
    {
        e = $element.parent()[0];
    }


    var offsetLeft = e.offsetLeft;
    var offsetTop = e.offsetTop;
    var offsetWidth = e.offsetWidth;
    var offsetHeight = e.offsetHeight;

    while(e = e.offsetParent) {
        offsetLeft += e.offsetLeft;
        offsetTop += e.offsetTop;
    }

    return new ReadiumSDK.Helpers.Rect(offsetLeft, offsetTop, offsetWidth, offsetHeight);
};

ReadiumSDK.Helpers.UpdateHtmlFontSize = function($epubHtml, fontSize){

    
    var factor = fontSize/100;
    var win = $epubHtml[0].ownerDocument.defaultView;
    var $textblocks = $(&#x27;p, div, span, h1, h2, h3, h4, h5, h6, li, blockquote, td, pre&#x27;, $epubHtml);
    var originalLineHeight;


    // need to do two passes because it is possible to have nested text blocks. 
    // If you change the font size of the parent this will then create an inaccurate
    // font size for any children. 
    for (var i = 0; i &lt; $textblocks.length; i++){
        var ele = $textblocks[i],
            fontSizeAttr = ele.getAttribute(&#x27;data-original-font-size&#x27;);

        if (!fontSizeAttr){
            var style = win.getComputedStyle(ele);
            var originalFontSize = parseInt(style.fontSize);
            originalLineHeight = parseInt(style.lineHeight);
            
            ele.setAttribute(&#x27;data-original-font-size&#x27;, originalFontSize);
            // getComputedStyle will not calculate the line-height if the value is &#x27;normal&#x27;. In this case parseInt will return NaN
            if (originalLineHeight){
                ele.setAttribute(&#x27;data-original-line-height&#x27;, originalLineHeight);
            }
        }
    }

    // reset variable so the below logic works. All variables in JS are function scoped. 
    originalLineHeight = 0;
    for (var i = 0; i &lt; $textblocks.length; i++){
        var ele = $textblocks[i],
            fontSizeAttr = ele.getAttribute(&#x27;data-original-font-size&#x27;),
            lineHeightAttr = ele.getAttribute(&#x27;data-original-line-height&#x27;),
            originalFontSize = Number(fontSizeAttr);

        if (lineHeightAttr){
            originalLineHeight = Number(lineHeightAttr);
        }
        else{
            originalLineHeight = 0;
        }

        ele.style.fontSize = (originalFontSize * factor) + &#x27;px&#x27;;
        if (originalLineHeight){
            ele.style.lineHeight = (originalLineHeight * factor) + &#x27;px&#x27;;
        }

    }
    $epubHtml.css(&quot;font-size&quot;, fontSize + &quot;%&quot;);
}


/**
 *
 * @param contentRef
 * @param sourceFileHref
 * @returns {string}
 * @constructor
 */
ReadiumSDK.Helpers.ResolveContentRef = function(contentRef, sourceFileHref) {

    if(!sourceFileHref) {
        return contentRef;
    }

    var sourceParts = sourceFileHref.split(&quot;/&quot;);
    sourceParts.pop(); //remove source file name

    var pathComponents = contentRef.split(&quot;/&quot;);

    while(sourceParts.length  &gt; 0 &amp;&amp; pathComponents[0] === &quot;..&quot;) {

        sourceParts.pop();
        pathComponents.splice(0, 1);
    }

    var combined = sourceParts.concat(pathComponents);

    return combined.join(&quot;/&quot;);

};


/**
 *
 * @param str
 * @param suffix
 * @returns {boolean}
 * @static
 */
ReadiumSDK.Helpers.EndsWith = function (str, suffix) {
    return str.indexOf(suffix, str.length - suffix.length) !== -1;
};

/**
 *
 * @param str
 * @param suffix
 * @returns {boolean}
 * @static
 */
ReadiumSDK.Helpers.BeginsWith = function (str, suffix) {

    return str.indexOf(suffix) === 0;
};

/**
 *
 * @param str
 * @param toRemove
 * @returns {string}
 * @static
 */
ReadiumSDK.Helpers.RemoveFromString = function(str, toRemove) {

    var startIx = str.indexOf(toRemove);

    if(startIx == -1) {
        return str;
    }

    return str.substring(0, startIx) + str.substring(startIx + toRemove.length);
};

/**
 *
 * @param margin
 * @param border
 * @param padding
 * @constructor
 */
ReadiumSDK.Helpers.Margins = function(margin, border, padding) {

    this.margin = margin;
    this.border = border;
    this.padding = padding;

    this.left =  this.margin.left + this.border.left + this.padding.left;
    this.right = this.margin.right + this.border.right + this.padding.right;
    this.top = this.margin.top + this.border.top + this.padding.top;
    this.bottom = this.margin.bottom + this.border.bottom + this.padding.bottom;

    this.width = function() {
        return this.left + this.right;
    };

    this.height = function() {
        return this.top + this.bottom;
    }
};

/**
 *
 * @param $iframe
 */
ReadiumSDK.Helpers.triggerLayout = function($iframe) {

    var doc = $iframe[0].contentDocument;

    if(!doc) {
        return;
    }
    
    var ss = undefined;
    try
    {
        ss = doc.styleSheets &amp;&amp; doc.styleSheets.length ? doc.styleSheets[0] : undefined;
        if (!ss)
        {
            var style = doc.createElement(&#x27;style&#x27;);
            doc.head.appendChild(style);
            style.appendChild(doc.createTextNode(&#x27;&#x27;));
            ss = style.sheet;
        }
    
        if (ss)
            ss.insertRule(&#x27;body:first-child::before {content:\&#x27;READIUM\&#x27;;color: red;font-weight: bold;}&#x27;, ss.cssRules.length);
    }
    catch (ex)
    {
        console.error(ex);
    }
    
    try
    {
        var el = doc.createElementNS(&quot;http://www.w3.org/1999/xhtml&quot;, &quot;style&quot;);
        el.appendChild(doc.createTextNode(&quot;*{}&quot;));
        doc.body.appendChild(el);
        doc.body.removeChild(el);

        if (ss)
            ss.deleteRule(ss.cssRules.length-1);
    }
    catch (ex)
    {
        console.error(ex);
    }

    if(doc.body) {
        var val = doc.body.offsetTop; // triggers layout
    }

};

/**
 *
 * @param $viewport
 * @param spineItem
 * @param settings
 * @returns {boolean}
 */
//Based on https://docs.google.com/spreadsheet/ccc?key=0AoPMUkQhc4wcdDI0anFvWm96N0xRT184ZE96MXFRdFE&amp;usp=drive_web#gid=0 doc
// Returns falsy and truthy
// true and false mean that the synthetic-spread or single-page is &quot;forced&quot; (to be respected whatever the external conditions)
// 1 and 0 mean that the synthetic-spread or single-page is &quot;not forced&quot; (is allowed to be overriden by external conditions, such as optimum column width / text line number of characters, etc.)
ReadiumSDK.Helpers.deduceSyntheticSpread = function($viewport, spineItem, settings) {

    if(!$viewport || $viewport.length == 0) {
        return 0; // non-forced
    }

    //http://www.idpf.org/epub/fxl/#property-spread-values

    var rendition_spread = spineItem ? spineItem.getRenditionSpread() : undefined;

    if(rendition_spread === ReadiumSDK.Models.SpineItem.RENDITION_SPREAD_NONE) {
        return false; // forced
        
        //&quot;Reading Systems must not incorporate this spine item in a synthetic spread.&quot;
    }

    if(settings.syntheticSpread == &quot;double&quot;) {
        return true; // forced
    }
    else if(settings.syntheticSpread == &quot;single&quot;) {
        return false; // forced
    }

    if(!spineItem) {
        return 0; // non-forced
    }

    if(rendition_spread === ReadiumSDK.Models.SpineItem.RENDITION_SPREAD_BOTH) {
        return true; // forced
        
        //&quot;Reading Systems should incorporate this spine item in a synthetic spread regardless of device orientation.&quot;
    }

    var orientation = ReadiumSDK.Helpers.getOrientation($viewport);

    if(rendition_spread === ReadiumSDK.Models.SpineItem.RENDITION_SPREAD_LANDSCAPE) {
        return orientation === ReadiumSDK.Views.ORIENTATION_LANDSCAPE; // forced
        
        //&quot;Reading Systems should incorporate this spine item in a synthetic spread only when the device is in landscape orientation.&quot;
    }

    if(rendition_spread === ReadiumSDK.Models.SpineItem.RENDITION_SPREAD_PORTRAIT) {
        return orientation === ReadiumSDK.Views.ORIENTATION_PORTRAIT; // forced
        
        //&quot;Reading Systems should incorporate this spine item in a synthetic spread only when the device is in portrait orientation.&quot;
    }

    if(!rendition_spread || rendition_spread === ReadiumSDK.Models.SpineItem.RENDITION_SPREAD_AUTO) {
        // if no spread set in document and user didn&#x27;t set in in setting we will do double for landscape
        var landscape = orientation === ReadiumSDK.Views.ORIENTATION_LANDSCAPE;
        return landscape ? 1 : 0; // non-forced

        //&quot;Reading Systems may use synthetic spreads in specific or all device orientations as part of a display area utilization optimization process.&quot;
    }

    console.warn(&quot;ReadiumSDK.Helpers.deduceSyntheticSpread: spread properties?!&quot;);
    return 0; // non-forced
};

/**
 *
 * @param $element
 * @returns {ReadiumSDK.Helpers.Rect}
 */
ReadiumSDK.Helpers.Margins.fromElement = function($element) {
    return new this($element.margin(), $element.border(), $element.padding());
};

/**
 * @returns {ReadiumSDK.Helpers.Rect}
 */
ReadiumSDK.Helpers.Margins.empty = function() {

    return new this({left:0, right:0, top:0, bottom: 0}, {left:0, right:0, top:0, bottom: 0}, {left:0, right:0, top:0, bottom: 0});

};

/**
 *
 * @param name
 * @param params
 * @returns {ReadiumSDK.Helpers.loadTemplate.cache}
 */
ReadiumSDK.Helpers.loadTemplate = function(name, params) {
    return ReadiumSDK.Helpers.loadTemplate.cache[name];
};

/**
 *
 * @type {{fixed_book_frame: string, single_page_frame: string, scrolled_book_frame: string, reflowable_book_frame: string, reflowable_book_page_frame: string}}
 */
ReadiumSDK.Helpers.loadTemplate.cache = {
    &quot;fixed_book_frame&quot; : &#x27;&lt;div id=&quot;fixed-book-frame&quot; class=&quot;clearfix book-frame fixed-book-frame&quot;&gt;&lt;/div&gt;&#x27;,
    
    &quot;single_page_frame&quot; : &#x27;&lt;div&gt;&lt;div id=&quot;scaler&quot;&gt;&lt;iframe scrolling=&quot;no&quot; class=&quot;iframe-fixed&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&#x27;,
    //&quot;single_page_frame&quot; : &#x27;&lt;div&gt;&lt;iframe scrolling=&quot;no&quot; class=&quot;iframe-fixed&quot; id=&quot;scaler&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&#x27;,
    
    &quot;scrolled_book_frame&quot; : &#x27;&lt;div id=&quot;reflowable-book-frame&quot; class=&quot;clearfix book-frame reflowable-book-frame&quot;&gt;&lt;div id=&quot;scrolled-content-frame&quot;&gt;&lt;/div&gt;&lt;/div&gt;&#x27;,
    &quot;reflowable_book_frame&quot; : &#x27;&lt;div id=&quot;reflowable-book-frame&quot; class=&quot;clearfix book-frame reflowable-book-frame&quot;&gt;&lt;/div&gt;&#x27;,
    &quot;reflowable_book_page_frame&quot;: &#x27;&lt;div id=&quot;reflowable-content-frame&quot; class=&quot;reflowable-content-frame&quot;&gt;&lt;iframe scrolling=&quot;no&quot; id=&quot;epubContentIframe&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&#x27;
};

/**
 *
 * @param styles
 * @param $element
 */
ReadiumSDK.Helpers.setStyles = function(styles, $element) {

    var count = styles.length;

    if(!count) {
        return;
    }

    for(var i = 0; i &lt; count; i++) {
        var style = styles[i];
        if(style.selector) {
            $(style.selector, $element).css(style.declarations);
        }
        else {
            $element.css(style.declarations);
        }
    }

};

/**
 *
 * @param iframe
 * @returns {boolean}
 */
ReadiumSDK.Helpers.isIframeAlive = function(iframe)
{
    var w = undefined;
    var d = undefined;
    try
    {
        w = iframe.contentWindow;
        d = iframe.contentDocument;
    }
    catch (ex)
    {
        console.error(ex);
        return false;
    }
    
    return w &amp;&amp; d;
}

/**
 *
 * @param $viewport
 * @returns {ReadiumSDK.Views.ORIENTATION_LANDSCAPE|ReadiumSDK.Views.ORIENTATION_PORTRAIT}
 */
ReadiumSDK.Helpers.getOrientation = function($viewport) {

    var viewportWidth = $viewport.width();
    var viewportHeight = $viewport.height();

    if(!viewportWidth || !viewportHeight) {
        return undefined;
    }

    return viewportWidth &gt;= viewportHeight ? ReadiumSDK.Views.ORIENTATION_LANDSCAPE : ReadiumSDK.Views.ORIENTATION_PORTRAIT;
};

/**
 *
 * @param item
 * @param orientation
 * @returns {boolean}
 */
ReadiumSDK.Helpers.isRenditionSpreadPermittedForItem = function(item, orientation) {

    var rendition_spread = item.getRenditionSpread();

    return  !rendition_spread
        ||  rendition_spread == ReadiumSDK.Models.SpineItem.RENDITION_SPREAD_BOTH
        ||  rendition_spread == ReadiumSDK.Models.SpineItem.RENDITION_SPREAD_AUTO
        ||  (rendition_spread == ReadiumSDK.Models.SpineItem.RENDITION_SPREAD_LANDSCAPE
        &amp;&amp; orientation == ReadiumSDK.Views.ORIENTATION_LANDSCAPE)
        ||  (rendition_spread == ReadiumSDK.Models.SpineItem.RENDITION_SPREAD_PORTRAIT
        &amp;&amp; orientation == ReadiumSDK.Views.ORIENTATION_PORTRAIT );
};

ReadiumSDK.Helpers.CSSTransition = function($el, trans) {
    
    // does not work!
    //$el.css(&#x27;transition&#x27;, trans);
    
    var css={};
    // empty &#x27;&#x27; prefix FIRST!
    _.each([&#x27;&#x27;, &#x27;-webkit-&#x27;, &#x27;-moz-&#x27;, &#x27;-ms-&#x27;], function(prefix) {
        css[prefix + &#x27;transition&#x27;] = prefix + trans;
    });
    $el.css(css);
}

//scale, left, top, angle, origin
ReadiumSDK.Helpers.CSSTransformString = function(options) {
    var enable3D = options.enable3D ? true : false;
    
    var translate, scale, rotation,
        origin = options.origin;

    if (options.left || options.top){
        var left = options.left || 0, 
            top = options.top || 0;

        translate = enable3D ? (&quot;translate3D(&quot; + left + &quot;px, &quot; + top + &quot;px, 0)&quot;) : (&quot;translate(&quot; + left + &quot;px, &quot; + top + &quot;px)&quot;);
    }
    if (options.scale){
        scale = enable3D ? (&quot;scale3D(&quot; + options.scale + &quot;, &quot; + options.scale + &quot;, 0)&quot;) : (&quot;scale(&quot; + options.scale + &quot;)&quot;);
    }
    if (options.angle){
        rotation =  enable3D ? (&quot;rotate3D(0,0,&quot; + options.angle + &quot;deg)&quot;) : (&quot;rotate(&quot; + options.angle + &quot;deg)&quot;);
    }
    
    if (!(translate || scale || rotation)){
        return {};
    }

    var transformString = (translate &amp;&amp; scale) ? (translate + &quot; &quot; + scale) : (translate ? translate : scale); // the order is important!
    if (rotation)
    {
        transformString = transformString + &quot; &quot; + rotation;
        //transformString = rotation + &quot; &quot; + transformString;
    }

    var css = {};
    css[&#x27;transform&#x27;] = transformString;
    css[&#x27;transform-origin&#x27;] = origin ? origin : (enable3D ? &#x27;0 0 0&#x27; : &#x27;0 0&#x27;);
    return css;
};

ReadiumSDK.Helpers.extendedThrottle = function (startCb, tickCb, endCb, tickRate, waitThreshold, context) {
    if (!tickRate) tickRate = 250;
    if (!waitThreshold) waitThreshold = tickRate;

    var first = true,
        last,
        deferTimer;

    return function () {
        var ctx = context || this,
            now = (Date.now &amp;&amp; Date.now()) || new Date().getTime(),
            args = arguments;

        if (!(last &amp;&amp; now &lt; last + tickRate)) {
            last = now;
            if (first) {
                startCb.apply(ctx, args);
                first = false;
            } else {
                tickCb.apply(ctx, args);
            }
        }

        clearTimeout(deferTimer);
        deferTimer = setTimeout(function () {
            last = now;
            first = true;
            endCb.apply(ctx, args);
        }, waitThreshold);
    };
};


//TODO: consider using CSSOM escape() or polyfill
//https://github.com/mathiasbynens/CSS.escape/blob/master/css.escape.js
//http://mathiasbynens.be/notes/css-escapes
/**
 *
 * @param sel
 * @returns {string}
 */
ReadiumSDK.Helpers.escapeJQuerySelector = function(sel) {
        //http://api.jquery.com/category/selectors/
        //!&quot;#$%&amp;&#x27;()*+,./:;&lt;=&gt;?@[\]^&#x60;{|}~
        // double backslash escape
        
        if (!sel) return undefined;
        
        var selector = sel.replace(/([;&amp;,\.\+\*\~\?&#x27;:&quot;\!\^#$%@\[\]\(\)&lt;=&gt;\|\/\\{}&#x60;])/g, &#x27;\\$1&#x27;);
        
        // if (selector !== sel)
        // {
        //     console.debug(&quot;---- SELECTOR ESCAPED&quot;);
        //     console.debug(&quot;1: &quot; + sel);
        //     console.debug(&quot;2: &quot; + selector);
        // }
        // else
        // {
        //     console.debug(&quot;---- SELECTOR OKAY: &quot; + sel);
        // }
        
        return selector;
};
    // TESTS BELOW ALL WORKING FINE :)
    // (RegExp typos are hard to spot!)
    // escapeSelector(&#x27;!&#x27;);
    // escapeSelector(&#x27;&quot;&#x27;);
    // escapeSelector(&#x27;#&#x27;);
    // escapeSelector(&#x27;$&#x27;);
    // escapeSelector(&#x27;%&#x27;);
    // escapeSelector(&#x27;&amp;&#x27;);
    // escapeSelector(&quot;&#x27;&quot;);
    // escapeSelector(&#x27;(&#x27;);
    // escapeSelector(&#x27;)&#x27;);
    // escapeSelector(&#x27;*&#x27;);
    // escapeSelector(&#x27;+&#x27;);
    // escapeSelector(&#x27;,&#x27;);
    // escapeSelector(&#x27;.&#x27;);
    // escapeSelector(&#x27;/&#x27;);
    // escapeSelector(&#x27;:&#x27;);
    // escapeSelector(&#x27;;&#x27;);
    // escapeSelector(&#x27;&lt;&#x27;);
    // escapeSelector(&#x27;=&#x27;);
    // escapeSelector(&#x27;&gt;&#x27;);
    // escapeSelector(&#x27;?&#x27;);
    // escapeSelector(&#x27;@&#x27;);
    // escapeSelector(&#x27;[&#x27;);
    // escapeSelector(&#x27;\\&#x27;);
    // escapeSelector(&#x27;]&#x27;);
    // escapeSelector(&#x27;^&#x27;);
    // escapeSelector(&#x27;&#x60;&#x27;);
    // escapeSelector(&#x27;{&#x27;);
    // escapeSelector(&#x27;|&#x27;);
    // escapeSelector(&#x27;}&#x27;);
    // escapeSelector(&#x27;~&#x27;);

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
